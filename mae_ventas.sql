CREATE SCHEMA IF NOT EXISTS   DOMO;

USE DOMO;

CREATE TABLE IF NOT EXISTS mae_ordenes(
sec_ordencommercev VARCHAR(100),
sec_orden VARCHAR(100),
fec_fechaorden DATE,
sec_nota INT,
sec_facura INT,
idu_clientecodigo VARCHAR(100),
nom_cliente varchar(100),
nom_apellidopaterno varchar(100),
nom_apellidomaterno varchar(100),
des_correoelectronico varchar(100),
num_telefono varchar(100),
opc_celular varchar(100),
nom_completorecibe  varchar(200),
idu_estadocodigo INT,
idu_MapaDomoCodigo INT,
nom_estado varchar(200),
idu_ciudadcodigo INT,
nom_ciudad varchar(200),
idu_coloniacodigo INT,
nom_colonia varchar(200),
nom_calle varchar(200),
nom_entrecalle varchar(200),
num_casa int,
num_interior int,
num_exterior int,
num_codigopostal int,
des_observaciones varchar(200),
idu_articulocodigo INT,
num_cantidad INT,
imp_preciounitario NUMERIC,
imp_preciounitarioSINIVA NUMERIC,
imp_preciocreditounitario INT,
imp_Enganche INT,
imp_SaldoNuevoRopa INT,
imp_gastodineroelectronico INT,
imp_ganodineroelectronico INT,
idu_articuloproductocommercecodigo VARCHAR(200),
idu_articuloitemcommercecodigo VARCHAR(200),
idu_tipopagocodigo INT,
des_tipopago VARCHAR(200),
des_tipocompra VARCHAR(200),
des_pagoinicial VARCHAR(200),
des_formapago VARCHAR(200),
des_tipopagogrupo VARCHAR(200),
des_tipopagogrupo2 VARCHAR(200),
des_tipopagogrupo3 VARCHAR(200),
idu_estatuspedidocodigo INT,
des_estatusorden VARCHAR(200),
idu_codigobanco INT,
des_establecimientobanco VARCHAR(200),
num_referencia BIGINT,
fec_FechaFacturacion VARCHAR(200),
idu_areacodigo BIGINT,
des_Area VARCHAR(200),
idu_departamentocodigo INT,
des_departamento VARCHAR(200),
idu_clasecodigo INT,
des_clase VARCHAR(200),
idu_familiacodigo INT,
des_familia VARCHAR(200),
des_categoria VARCHAR(200),
des_subcategoria VARCHAR(200),
des_clasificacionantad INT,
nom_articulo VARCHAR(200),
des_articulo VARCHAR(200),
num_talla INT,
des_modelo VARCHAR(200),
des_color VARCHAR(200),
des_marca VARCHAR(200),
des_EstatusAccertify VARCHAR(200),
fec_fechaordencommerce VARCHAR(200),
des_BuildingBlock VARCHAR(200),
des_buildingblockagg VARCHAR(200),
des_Fuente VARCHAR(200),
des_Medio VARCHAR(200),
des_campagna VARCHAR(200),
des_Dispositivo VARCHAR(200),
des_canalventa VARCHAR(200),
des_servicio VARCHAR(200),
idu_TiendaCodigoR INT,
nom_NombreTiendaR VARCHAR(200),
idu_FormatoTiendaCodigoR INT,
des_FormatoTiendaR VARCHAR(200),
idu_CiudadTiendaCodigoR INT,
nom_NombreCiudadR VARCHAR(200),
flag_ventafuturo INT,
num_tiendaCT INT,
des_FormatoCT VARCHAR(200),
flag_logeado INT
);

DROP table  mae_ordenes;


-- 4) cargar los datos
LOAD DATA INFILE '/var/lib/mysql-files/mae_ordenes.csv'
into table mae_ordenes
FIELDS TERMINATED BY '|'
ENCLOSED BY ''
LINES terminated by '\n'
IGNORE 1 ROWS

(@sec_ordencommercev ,
@sec_orden ,
@fec_fechaorden ,
@sec_nota ,
@sec_facura ,
@idu_clientecodigo ,
@nom_cliente ,
@nom_apellidopaterno ,
@nom_apellidomaterno ,
@des_correoelectronico ,
@num_telefono,
@opc_celular,
@nom_completorecibe  ,
@idu_estadocodigo ,
@idu_MapaDomoCodigo ,
@nom_estado ,
@idu_ciudadcodigo ,
@nom_ciudad ,
@idu_coloniacodigo ,
@nom_colonia ,
@nom_calle ,
@nom_entrecalle ,
@num_casa ,
@num_erior ,
@num_exterior ,
@num_codigopostal ,
@des_observaciones ,
@idu_articulocodigo ,
@num_cantidad ,
@imp_preciounitario ,
@imp_preciounitarioSINIVA,
@imp_preciocreditounitario ,
@imp_Enganche ,
@imp_SaldoNuevoRopa ,
@imp_gastodineroelectronico ,
@imp_ganodineroelectronico ,
@idu_articuloproductocommercecodigo ,
@idu_articuloitemcommercecodigo ,
@idu_tipopagocodigo ,
@des_tipopago ,
@des_tipocompra ,
@des_pagoinicial ,
@des_formapago ,
@des_tipopagogrupo ,
@des_tipopagogrupo2 ,
@des_tipopagogrupo3 ,
@idu_estatuspedidocodigo ,
@des_estatusorden ,
@idu_codigobanco ,
@des_establecimientobanco ,
@num_referencia ,
@fec_FechaFacturacion ,
@idu_areacodigo ,
@des_Area ,
@idu_departamentocodigo ,
@des_departamento ,
@idu_clasecodigo ,
@des_clase ,
@idu_familiacodigo ,
@des_familia ,
@des_categoria ,
@des_subcategoria ,
@des_clasificacionantad ,
@nom_articulo ,
@des_articulo ,
@num_talla ,
@des_modelo ,
@des_color ,
@des_marca ,
@des_EstatusAccertify ,
@fec_fechaordencommerce ,
@des_BuildingBlock ,
@des_buildingblockagg ,
@des_Fuente ,
@des_Medio ,
@des_campagna ,
@des_Dispositivo ,
@des_canalventa ,
@des_servicio ,
@idu_TiendaCodigoR ,
@nom_NombreTiendaR ,
@idu_FormatoTiendaCodigoR ,
@des_FormatoTiendaR ,
@idu_CiudadTiendaCodigoR ,
@nom_NombreCiudadR ,
@flag_ventafuturo ,
@num_tiendaCT ,
@des_FormatoCT ,
@flag_logeado)

SET 
sec_ordencommercev= NULLIF(@sec_ordencommercev,0),
sec_orden= NULLIF(@sec_orden,0),
fec_fechaorden= NULLIF(@fec_fechaorden,0),
sec_nota= NULLIF(@sec_nota,0),
sec_facura= NULLIF(@sec_facura,0),
idu_clientecodigo= NULLIF(@idu_clientecodigo,0),
nom_cliente= NULLIF(@nom_cliente,0),
nom_apellidopaterno= NULLIF(@nom_apellidopaterno,0),
nom_apellidomaterno= NULLIF(@nom_apellidomaterno,0),
des_correoelectronico= NULLIF(@nom_apellidomaterno,0),
num_telefono = NULLIF(@num_telefono,0),
opc_celular= NULLIF(@opc_celular,0),
nom_completorecibe = NULLIF(@nom_completorecibe,0),
idu_estadocodigo= NULLIF(@idu_estadocodigo,0),
idu_MapaDomoCodigo= NULLIF(@idu_MapaDomoCodigo,0),
nom_estado= NULLIF(@nom_estado,0),
idu_ciudadcodigo= NULLIF(@idu_ciudadcodigo,0),
nom_ciudad= NULLIF(@nom_ciudad,0),
idu_coloniacodigo= NULLIF(@idu_coloniacodigo,0),
nom_colonia= NULLIF(@nom_colonia,0),
nom_calle= NULLIF(@nom_calle,0),
nom_entrecalle= NULLIF(@nom_entrecalle,0),
num_casa= NULLIF(@num_casa,0),
num_interior= NULLIF(@num_interior,0),
num_exterior= NULLIF(@num_exterior,0),
num_codigopostal= NULLIF(@num_codigopostal,0),
des_observaciones= NULLIF(@des_observaciones,0),
idu_articulocodigo= NULLIF(@idu_articulocodigo,0),
num_cantidad= NULLIF(@num_cantidad,0),
imp_preciounitario= NULLIF(@imp_preciounitario,0),
imp_preciounitarioSINIVA = NULLIF(@imp_preciounitarioSINIVA,0),
imp_preciocreditounitario= NULLIF(@imp_preciocreditounitario,0),
imp_Enganche= NULLIF(@imp_Enganche,0),
imp_SaldoNuevoRopa= NULLIF(@imp_SaldoNuevoRopa,0),
imp_gastodineroelectronico= NULLIF(@imp_gastodineroelectronico,0),
imp_ganodineroelectronico= NULLIF(@imp_ganodineroelectronico,0),
idu_articuloproductocommercecodigo= NULLIF(@idu_articuloproductocommercecodigo,0),
idu_articuloitemcommercecodigo= NULLIF(@idu_articuloitemcommercecodigo,0),
idu_tipopagocodigo= NULLIF(@idu_tipopagocodigo,0),
des_tipopago= NULLIF(@des_tipopago,0),
des_tipocompra= NULLIF(@des_tipocompra,0),
des_pagoinicial= NULLIF(@des_pagoinicial,0),
des_formapago= NULLIF(@des_formapago,0),
des_tipopagogrupo= NULLIF(@des_tipopagogrupo,0),
des_tipopagogrupo2= NULLIF(@des_tipopagogrupo2,0),
des_tipopagogrupo3= NULLIF(@des_tipopagogrupo3,0),
idu_estatuspedidocodigo= NULLIF(@idu_estatuspedidocodigo,0),
des_estatusorden= NULLIF(@idu_estatuspedidocodigo,0),
idu_codigobanco= NULLIF(@idu_codigobanco,0),
des_establecimientobanco= NULLIF(@des_establecimientobanco,0),
num_referencia= NULLIF(@num_referencia,0),
fec_FechaFacturacion= NULLIF(@fec_FechaFacturacion,0),
idu_areacodigo= NULLIF(@idu_areacodigo,0),
des_Area= NULLIF(@des_Area,0),
idu_departamentocodigo= NULLIF(@idu_departamentocodigo,0),
des_departamento= NULLIF(@des_departamento,0),
idu_clasecodigo= NULLIF(@idu_clasecodigo,0),
des_clase= NULLIF(@des_clase,0),
idu_familiacodigo= NULLIF(@idu_familiacodigo,0),
des_familia= NULLIF(@des_familia,0),
des_categoria= NULLIF(@des_categoria,0),
des_subcategoria= NULLIF(@des_subcategoria,0),
des_clasificacionantad= NULLIF(@des_clasificacionantad,0),
nom_articulo= NULLIF(@nom_articulo,0),
des_articulo= NULLIF(@des_articulo,0),
num_talla= NULLIF(@num_talla,0),
des_modelo= NULLIF(@des_modelo,0),
des_color= NULLIF(@des_color,0),
des_marca= NULLIF(@des_marca,0),
des_EstatusAccertify= NULLIF(@des_EstatusAccertify,0),
fec_fechaordencommerce= NULLIF(@fec_fechaordencommerce,0),
des_BuildingBlock= NULLIF(@des_BuildingBlock,0),
des_buildingblockagg= NULLIF(@des_buildingblockagg,0),
des_Fuente= NULLIF(@des_Fuente,0),
des_Medio= NULLIF(@des_Medio,0),
des_campagna= NULLIF(@des_campagna,0),
des_Dispositivo= NULLIF(@des_Dispositivo,0),
des_canalventa= NULLIF(@des_canalventa,0),
des_servicio= NULLIF(@des_servicio,0),
idu_TiendaCodigoR= NULLIF(@idu_TiendaCodigoR,0),
nom_NombreTiendaR= NULLIF(@nom_NombreTiendaR,0),
idu_FormatoTiendaCodigoR= NULLIF(@idu_FormatoTiendaCodigoR,0),
des_FormatoTiendaR= NULLIF(@des_FormatoTiendaR,0),
idu_CiudadTiendaCodigoR= NULLIF(@idu_CiudadTiendaCodigoR,0),
nom_NombreCiudadR= NULLIF(@nom_NombreCiudadR,0),
flag_ventafuturo= NULLIF(@flag_ventafuturo,0),
num_tiendaCT= NULLIF(@num_tiendaCT,0),
des_FormatoCT= NULLIF(@des_FormatoCT,0),
flag_logeado= NULLIF(@flag_logeado,0);
